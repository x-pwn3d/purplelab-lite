# ğŸŸ£ PurpleLab-lite

[![Platform](https://img.shields.io/badge/Platform-Windows%20%7C%20Linux-lightgrey)](https://github.com/x-pwn3d/mini-c2)
[![Python](https://img.shields.io/badge/Python-3.10%2B-blue)](https://www.python.org/)
[![Status](https://img.shields.io/badge/Status-Functional-brightgreen)](https://github.com/x-pwn3d/mini-c2)
![License](https://img.shields.io/badge/License-MIT-orange)
![TLS](https://img.shields.io/badge/TLS-Lab%20Certs-blue)
![Lab](https://img.shields.io/badge/Lab-Educational-lightgrey)

---

## ğŸ“– Project Overview

**PurpleLab-lite** is a **lightweight, automated Purple Team lab** designed for cybersecurity training and testing.  
It allows security practitioners and students to **simulate real-world attack scenarios** against a vulnerable web application while automatically collecting and analyzing logs for indicators of compromise (IoCs).

Key objectives:  

- Deploy a vulnerable target: **[OWASP Juice Shop](https://owasp.org/www-project-juice-shop/)**  
- Automatically launch a variety of attacks:
  - SQL Injection (SQLi)  
  - Webshell uploads  
  - Malicious User Agents  
- Collect and analyze logs (`access.log`, `error.log`)  
- Detect IoCs using **YARA rules** and **regex patterns** (YARA is included in the Docker container)  
- Generate comprehensive automatic reports (`reports/report.md`)  

This lab is ideal for **Purple Team exercises, SIEM testing, and security education**, all on a single machine.

---

## âš™ï¸ Requirements

- **Docker** & **docker-compose** installed  
- **Python 3.9+** (for local scripts if needed)  

> No need to install YARA locally, it is already included in the Docker container.

---

## ğŸš€ Usage

```bash
# Build and start the full lab environment (attacker + target + logs)
docker compose up --build
````

This will:

1. Launch the vulnerable Juice Shop application in a container
2. Start the attacker and harness containers to execute attack scenarios
3. Collect logs and automatically detect suspicious activity
4. Generate a Markdown report at `reports/report.md`

---

## ğŸ—‚ Directory Structure

```
PurpleLab-lite/
â”œâ”€â”€ attacks/                # Attack scripts (SQLi, webshell uploads, UA tests)
â”œâ”€â”€ logs/                   # Logs generated by the lab (ignored by git)
â”œâ”€â”€ reports/                # Generated reports (ignored by git)
â”œâ”€â”€ detections/             # YARA rules for detection
â”œâ”€â”€ harness.py              # Main orchestrator script
â”œâ”€â”€ Dockerfile.harness      # Dockerfile for harness container
â”œâ”€â”€ docker-compose.yml      # Compose file for lab environment
â”œâ”€â”€ README.md
â””â”€â”€ .gitignore
```

---

## ğŸ§© Detection & Reporting

* **YARA rules**:

  * `logs_and_webshells.yar`: Detects webshells and suspicious log patterns
  * `sqli.yar`: Detects SQLi attempts (tautologies, UNION, time-based, comment-style)
* **Regex/Grep patterns**: Detect malicious User Agents or custom keywords
* **Automatic Markdown report**: Lists all matches with files and rules triggered

---

## â„¹ï¸ Note about HTTP responses, snippets and â€œerrorsâ€ in the report

While running attack scenarios you may see HTTP response codes like **500**, **401**, etc. appear in the attacker logs and the generated report. This is expected and not an indication of a harness failure.

**HTTP 500 (Internal Server Error)** - typically occurs when sending intentionally malformed SQLi payloads. Juice Shop returns 500 for such malformed input; thatâ€™s expected since we intentionally test error-handling and parsing paths.

**HTTP 401 (Unauthorized)** - appears for login attempts with incorrect credentials. Again, expected for login-focused attack payloads.

**Snippets in the report** - the harness captures a short response snippet (first bytes) to demonstrate what the attacker observed. These snippets help validate that payloads were processed and reveal whether error messages or stack traces were returned, useful for Purple Team analysis and detection tuning.

So: **500/401 + snippets = normal**. They provide valuable context for detection development and incident analysis.

---

## âš¡ Contribution

Contributions are welcome!

* Add new attack scenarios
* Extend YARA rules for additional IoCs
* Improve report formatting

Please submit a **pull request** or **issue** on GitHub.

---

## ğŸ“œ License

This project is licensed under the **MIT License** - see [LICENSE](./LICENSE) for details.
